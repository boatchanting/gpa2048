<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>é©¬åŸæ±‡æŠ¥äº’åŠ¨å°æ¸¸æˆâ€”â€”â€”â€”ç»©ç‚¹48æ¸¸æˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      background: #faf8ef;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      min-height: 100vh;
    }
    .header {
      background: #bbada0;
      padding: 15px;
      text-align: center;
      color: #fff;
      font-size: 2em;
      font-weight: bold;
      width: 100%;
    }
    .score-panel {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 400px;
      margin: 20px;
    }
    .score, .transcript-btn {
      background: #8f7a66;
      color: #fff;
      padding: 10px 20px;
      border-radius: 5px;
      font-size: 1.2em;
      cursor: pointer;
    }
    .grid-container {
      display: grid;
      grid-template-columns: repeat(4, 80px);
      grid-template-rows: repeat(4, 80px);
      gap: 8px;
      background: #bbada0;
      padding: 8px;
      border-radius: 4px;
    }
    .grid-cell {
      width: 80px;
      height: 80px;
      background: #cdc1b4;
      border-radius: 4px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 20px;
      font-weight: bold;
      color: #776e65;
    }

    .footer {
      margin-top: 20px;
      text-align: center;
      font-size: 0.9em;
      color: #776e65;
    }
    .footer-link {
      color: #776e65;
      text-decoration: none;
      font-weight: bold;
      transition: color 0.3s ease;
    }
    .footer-link:hover {
      color: #8f7a66;
    }

    /* ç§»åŠ¨ç«¯ä¼˜åŒ– */
    @media (max-width: 600px) {
      .header {
        font-size: 1.5em;
        padding: 10px;
      }
      
      .score-panel {
        flex-direction: column;
        gap: 10px;
      }
      
      .score, .transcript-btn {
        font-size: 1em;
        padding: 8px 16px;
        margin: 5px 0;
      }
      
      .grid-cell {
        font-size: 1em;
      }
      
      .controller {
        margin: 15px 0;
      }
      
      .top-button, .bottom-button {
        padding: 12px;
        font-size: 1.2em;
      }
      
      .footer {
        font-size: 0.8em;
        padding: 10px;
      }
    }

    /*
    æ¨¡æ‹Ÿä¸Šä¸‹å·¦å³æ§ä»¶
    ç”¨äºå¯¹æ‰‹æœºç«¯è¿›è¡Œé€‚é…
    */
    .controller {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 20px;
    }
    .top-button {
      width: 50px;
      height: 50px;
      background-color: #8f7a66;
      border: 1px solid #776e65;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 10px;
      font-size: 20px;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
      border-radius: 8px;
    }
    .bottom-buttons {
        display: flex;
        justify-content: center;
    }
    .bottom-button {
        width: 50px;
        height: 50px;
        background-color: #8f7a66;
        border: 1px solid #776e65;
        display: flex;
        justify-content: center;
        align-items: center;
        margin: 5px;
        font-size: 20px;
        color: #fff;
        cursor: pointer;
        box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
        border-radius: 8px;
    }

    /* æˆç»©å•å¼¹çª—æ•´ä½“é®ç½© */
    .transcript-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width:100%;
    height:100%;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    }

    /* æˆç»©å•å†…å®¹åŒºåŸŸ */
    .transcript-container {
    background: #fff;
    padding: 30px;
    border-radius: 10px;
    max-width: 90%;
    max-height: 90%;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    text-align: center;
    overflow-y: auto;
    }

    /* æ ‡é¢˜æ ·å¼ */
    .transcript-container h2 {
    margin-top: 0;
    font-size: 2em;
    color: #333;
    }

    /* æˆç»©å•è¡¨æ ¼æ ·å¼ */
    .transcript-table {
    width: 100%;
    border-collapse: collapse;
    margin: 20px 0;
    }
    .transcript-table th,
    .transcript-table td {
    border: 1px solid #ddd;
    padding: 10px;
    }
    .transcript-table th {
    background-color: #f4f4f4;
    color: #333;
    }

    /* å…³é—­æŒ‰é’®æ ·å¼ */
    .close-btn {
    background: #8f7a66;
    color: #fff;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    }
    .close-btn:hover {
    background: #7a6457;
    }
  </style>
</head>
<body>
  <div class="header">é©¬åŸæ±‡æŠ¥äº’åŠ¨å°æ¸¸æˆâ€”â€”â€”â€”ç»©ç‚¹48æ¸¸æˆ</div>
  
  <div class="score-panel">
    <div class="score" id="scoreDisplay">ç»©ç‚¹: 0.00</div>
    
    <button class="transcript-btn" onclick="generateTranscript()">æˆ‘çš„æˆç»©å•</button>
  </div>
  <div class="grid-container" id="grid-container">
    <!-- 16ä¸ªç½‘æ ¼ -->
    <div class="grid-cell" id="cell-0-0"></div>
    <div class="grid-cell" id="cell-1-0"></div>
    <div class="grid-cell" id="cell-2-0"></div>
    <div class="grid-cell" id="cell-3-0"></div>
    <div class="grid-cell" id="cell-0-1"></div>
    <div class="grid-cell" id="cell-1-1"></div>
    <div class="grid-cell" id="cell-2-1"></div>
    <div class="grid-cell" id="cell-3-1"></div>
    <div class="grid-cell" id="cell-0-2"></div>
    <div class="grid-cell" id="cell-1-2"></div>
    <div class="grid-cell" id="cell-2-2"></div>
    <div class="grid-cell" id="cell-3-2"></div>
    <div class="grid-cell" id="cell-0-3"></div>
    <div class="grid-cell" id="cell-1-3"></div>
    <div class="grid-cell" id="cell-2-3"></div>
    <div class="grid-cell" id="cell-3-3"></div>
    <div id="tile-container"></div>
  </div>
  
  <div class="controller">
    <div class="top-button" id="up">â†‘</div>
    <div class="bottom-buttons">
        <div class="bottom-button" id="left">â†</div>
        <div class="bottom-button" id="down">â†“</div>
        <div class="bottom-button" id="right">â†’</div>
    </div>
  </div>
  <div class="score" id="highestScoreDisplay" style="margin: 20px 0;">å†å²æœ€é«˜ç»©ç‚¹: 0.00</div>
  <div class="footer">
    <p><a href="https://boatchanting.github.io/gpa2048/rules.html" target="_blank" class="footer-link"> è¯¦ç»†æ¸¸æˆè¯´æ˜ç‚¹æˆ‘æŸ¥çœ‹ğŸš€</a></p>
    <p>åˆå¹¶æ–¹å—ä»¥æå‡ç»©ç‚¹ï¼Œæ¯ä¸ªæ–¹å—ä»£è¡¨ä¸€é—¨è¯¾ç¨‹çš„æˆç»©ã€‚æ”¯æŒé”®ç›˜ï¼ˆW/A/S/Dï¼‰åŠæ»‘åŠ¨æ“ä½œã€‚</p>
    <p><strong>é©¬åŸæ±‡æŠ¥ç¬¬ä¸‰å°ç»„åˆ¶ä½œ</strong></p>
    <p><strong>å¼ æ’ç¥¯ éŸ¦æ™— åˆ˜å¥•é˜³ é«˜è¡Œå‘¨ è°­è‡³è¿œ</strong></p>
    <p><a href="https://boatchanting.github.io/funthings.html" class="footer-link">ç‚¹æˆ‘æŸ¥çœ‹æ›´å¤šå¥½ç©çš„é¡¹ç›®ğŸš€</a></p>
  </div>
</body>
<script>
    // æ¸¸æˆæ•°æ®ä¸é…ç½®
    const gridSize = 4;
    let grid = [];
    let hasMoved = false;
    
    // å®šä¹‰æ–¹å—æ•°å€¼ä¸æ˜¾ç¤ºæ–‡æœ¬çš„æ˜ å°„
    const tileTexts = {
      2: "ä¸åŠæ ¼",
      4: "è¢«æåˆ°åŠæ ¼",
      8: "åŠæ ¼",
      16: "è¢«æåˆ°ä¸­",
      32: "ä¸­",
      64: "è¢«å¡åˆ°ä¸­",
      128: "è¢«æåˆ°è‰¯",
      256: "è‰¯",
      512: "è¢«æåˆ°ä¼˜",
      1024: "ä¼˜",
      2048: "å…ä¿®å¾—ä¼˜"
    };
    
    // æ–°æ–¹å—åªå¯èƒ½æ˜¯è¿™å‡ ç§å€¼
    const newTileValues = [2, 2, 2, 2, 4];
    
    // è®¡ç®—æ¯ä¸ªæ–¹å—è½¬æ¢ä¸ºåŸºç¡€ç­‰çº§ä»¥åŠå¯¹åº”ç»©ç‚¹ï¼ˆç”¨äºæˆç»©å•å’Œæ¸¸æˆç»©ç‚¹æ˜¾ç¤ºï¼‰  
    function getBaseGrade(value) {
      if (value === 2) return "ä¸åŠæ ¼";
      if (value === 4 || value === 8) return "åŠæ ¼";
      if (value === 16 || value === 32 || value === 64) return "ä¸­";
      if (value === 128 || value === 256) return "è‰¯";
      if (value === 512 || value === 1024) return "ä¼˜";
      if (value === 2048) return "å…ä¿®å¾—ä¼˜";
      return "";
    }
    function getGradePoint(value) {
      const base = getBaseGrade(value);
      // ä¸åŠæ ¼ï¼š0ï¼ŒåŠæ ¼ï¼š2ï¼Œä¸­ï¼š3ï¼Œè‰¯ï¼š4ï¼Œä¼˜/å…ä¿®å¾—ä¼˜ï¼š5
      switch (base) {
        case "ä¸åŠæ ¼": return 0;
        case "åŠæ ¼": return 2;
        case "ä¸­": return 3;
        case "è‰¯": return 4;
        case "ä¼˜": return 5;
        case "å…ä¿®å¾—ä¼˜": return 5;
        default: return 0;
      }
    }
    
    // æ¸¸æˆåˆå§‹åŒ–ï¼šå»ºç«‹ç©ºæ£‹ç›˜ï¼Œå¹¶éšæœºç”Ÿæˆä¸¤ä¸ªæ–°æ–¹å—
    function initGame() {
      grid = [];
      for (let i = 0; i < gridSize; i++) {
        let row = [];
        for (let j = 0; j < gridSize; j++) {
          row.push(0);
        }
        grid.push(row);
      }
      spawnTile();
      spawnTile();
      updateGrid();
      updateScoreDisplay();
    }
    
    // åœ¨éšæœºç©ºæ ¼ä¸­ç”Ÿæˆä¸€ä¸ªæ–°æ–¹å—
    function spawnTile() {
      const emptyCells = [];
      for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
          if (grid[i][j] === 0) {
            emptyCells.push({ i, j });
          }
        }
      }
      if (emptyCells.length === 0) return;
      const { i, j } = emptyCells[Math.floor(Math.random() * emptyCells.length)];
      // éšæœºé€‰æ‹©ä¸€ä¸ªæ–°æ–¹å—æ•°å€¼
      grid[i][j] = newTileValues[Math.floor(Math.random() * newTileValues.length)];
    }
    
    // æ›´æ–°é¡µé¢æ˜¾ç¤ºï¼ˆæ¯ä¸ªç½‘æ ¼æ˜¾ç¤ºå¯¹åº”çš„æ–‡å­—æˆ–ç©ºç™½ï¼‰
    function updateGrid() {
      for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
          const cell = document.getElementById(`cell-${j}-${i}`);
          if (grid[i][j] !== 0) {
            cell.textContent = tileTexts[grid[i][j]];
            // å¯æ ¹æ®æ•°å€¼è°ƒæ•´æ ·å¼ï¼Œæ¯”å¦‚èƒŒæ™¯è‰²
            cell.style.background = getBackgroundColor(grid[i][j]);
          } else {
            cell.textContent = "";
            cell.style.background = "#cdc1b4";
          }
        }
      }
    }
    
    // ç®€å•çš„èƒŒæ™¯è‰²æ˜ å°„
    function getBackgroundColor(value) {
      switch (value) {
        case 2: return "#eee4da";
        case 4: return "#ede0c8";
        case 8: return "#f2b179";
        case 16: return "#f59563";
        case 32: return "#f67c5f";
        case 64: return "#f65e3b";
        case 128: return "#edcf72";
        case 256: return "#edcc61";
        case 512: return "#edc850";
        case 1024: return "#edc53f";
        case 2048: return "#edc22e";
        default: return "#cdc1b4";
      }
    }

    // åˆå§‹åŒ–æœ€é«˜ç»©ç‚¹ï¼ˆä»æœ¬åœ°å­˜å‚¨è¯»å–æˆ–é»˜è®¤0ï¼‰
    let highestScore = parseFloat(localStorage.getItem('highestScore')) || 0;

    // è®¡ç®—å¹¶æ›´æ–°å½“å‰æ¸¸æˆç»©ç‚¹ï¼ˆä½¿ç”¨æ¯ä¸ªéç©ºæ–¹å—ç»©ç‚¹å¹³å‡å€¼ï¼‰
    function updateScoreDisplay() {
        let total = 0, count = 0;
        for (let i = 0; i < gridSize; i++) {
            for (let j = 0; j < gridSize; j++) {
                if (grid[i][j] !== 0) {
                    total += getGradePoint(grid[i][j]);
                    count++;
                }
            }
        }
        const currentScore = count === 0 ? 0 : parseFloat((total / count).toFixed(2));
        const scoreDisplay = document.getElementById("scoreDisplay");
        scoreDisplay.textContent = "ç»©ç‚¹: " + currentScore.toFixed(2);

        // æ›´æ–°å†å²æœ€é«˜ç»©ç‚¹
        if (currentScore > highestScore) {
            highestScore = currentScore;
            document.getElementById("highestScoreDisplay").textContent = 
                "å†å²æœ€é«˜ç»©ç‚¹: " + highestScore.toFixed(2);
            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
            localStorage.setItem('highestScore', highestScore);
        }
    }

    // åˆå§‹åŒ–æ—¶æ˜¾ç¤ºå†å²æœ€é«˜åˆ†ï¼ˆåœ¨é¡µé¢åŠ è½½æ—¶è°ƒç”¨ï¼‰
    document.getElementById("highestScoreDisplay").textContent = 
        "å†å²æœ€é«˜ç»©ç‚¹: " + highestScore.toFixed(2);
    
    // ç§»åŠ¨é€»è¾‘ï¼šå°†ä¸€è¡Œä¸­çš„æ•°å­—å‘å·¦åˆå¹¶
    function slideAndMerge(row) {
      let arr = row.filter(val => val !== 0);
      // åˆå¹¶ç›¸é‚»ä¸”ç›¸åŒçš„æ•°å­—ï¼ˆæ³¨æ„2048ä¸å¯å†åˆå¹¶ï¼‰
      for (let i = 0; i < arr.length - 1; i++) {
        if (arr[i] === arr[i + 1] && arr[i] !== 2048) {
          arr[i] = arr[i] * 2;
          arr[i + 1] = 0;
          i++; // åˆå¹¶åè·³è¿‡ä¸‹ä¸€ä¸ª
          hasMoved = true;
        }
      }
      arr = arr.filter(val => val !== 0);
      // è¡¥è¶³ç©ºæ ¼
      while (arr.length < gridSize) {
        arr.push(0);
      }
      return arr;
    }
    
    // æ ¹æ®æ–¹å‘ç§»åŠ¨æ£‹ç›˜ï¼šleft, right, up, down
    function moveLeft() {
      hasMoved = false;
      for (let i = 0; i < gridSize; i++) {
        let oldRow = grid[i].slice();
        grid[i] = slideAndMerge(grid[i]);
        if (!hasMoved && !arraysEqual(oldRow, grid[i])) {
          hasMoved = true;
        }
      }
      postMove();
    }
    
    function moveRight() {
      hasMoved = false;
      for (let i = 0; i < gridSize; i++) {
        let oldRow = grid[i].slice();
        grid[i] = slideAndMerge(grid[i].slice().reverse()).reverse();
        if (!hasMoved && !arraysEqual(oldRow, grid[i])) {
          hasMoved = true;
        }
      }
      postMove();
    }
    
    function moveUp() {
      hasMoved = false;
      for (let j = 0; j < gridSize; j++) {
        let col = [];
        for (let i = 0; i < gridSize; i++) {
          col.push(grid[i][j]);
        }
        let oldCol = col.slice();
        col = slideAndMerge(col);
        for (let i = 0; i < gridSize; i++) {
          grid[i][j] = col[i];
        }
        if (!hasMoved && !arraysEqual(oldCol, col)) {
          hasMoved = true;
        }
      }
      postMove();
    }
    
    function moveDown() {
      hasMoved = false;
      for (let j = 0; j < gridSize; j++) {
        let col = [];
        for (let i = 0; i < gridSize; i++) {
          col.push(grid[i][j]);
        }
        let oldCol = col.slice();
        col = slideAndMerge(col.reverse()).reverse();
        for (let i = 0; i < gridSize; i++) {
          grid[i][j] = col[i];
        }
        if (!hasMoved && !arraysEqual(oldCol, col)) {
          hasMoved = true;
        }
      }
      postMove();
    }
    
    // åˆå¹¶åŠ¨ä½œåå¤„ç†ï¼šè‹¥æœ‰ç§»åŠ¨ï¼Œåˆ™ç”Ÿæˆæ–°æ–¹å—ã€æ›´æ–°ç•Œé¢å¹¶æ£€æµ‹æ¸¸æˆç»“æŸ
    function postMove() {
      if (hasMoved) {
        spawnTile();
        updateGrid();
        updateScoreDisplay();
        if (checkGameOver()) {
          setTimeout(() => {
            alert("æ¸¸æˆç»“æŸï¼Œè¯·æŸ¥çœ‹æˆç»©å•ï¼");
          }, 200);
        }
      }
    }
    
    // æ£€æŸ¥ä¸¤ä¸ªæ•°ç»„æ˜¯å¦ç›¸ç­‰
    function arraysEqual(a, b) {
      if (a.length !== b.length) return false;
      for (let i = 0; i < a.length; i++) {
        if (a[i] !== b[i]) return false;
      }
      return true;
    }
    
    // æ£€æŸ¥æ¸¸æˆæ˜¯å¦ç»“æŸï¼ˆæ— ç©ºæ ¼ä¸”æ— å¯åˆå¹¶æ–¹å—ï¼‰
    function checkGameOver() {
      // è‹¥æœ‰ç©ºæ ¼ï¼Œç»§ç»­æ¸¸æˆ
      for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
          if (grid[i][j] === 0) return false;
        }
      }
      // æ£€æŸ¥æ°´å¹³æ–¹å‘å’Œå‚ç›´æ–¹å‘çš„ç›¸é‚»æ–¹å—æ˜¯å¦æœ‰ç›¸åŒï¼ˆä¸”ä¸ä¸º2048ï¼‰
      for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
          if (j < gridSize - 1 && grid[i][j] === grid[i][j + 1] && grid[i][j] !== 2048) return false;
          if (i < gridSize - 1 && grid[i][j] === grid[i + 1][j] && grid[i][j] !== 2048) return false;
        }
      }
      return true;
    }
    
    // é”®ç›˜äº‹ä»¶å¤„ç†ï¼ˆæ”¯æŒW/A/S/Då’Œæ–¹å‘é”®ï¼‰
    document.addEventListener("keydown", (e) => {
      switch (e.key.toLowerCase()) {
        case "w":
        case "arrowup":
          moveUp();
          break;
        case "a":
        case "arrowleft":
          moveLeft();
          break;
        case "s":
        case "arrowdown":
          moveDown();
          break;
        case "d":
        case "arrowright":
          moveRight();
          break;
      }
    });
    
    // æ–°å¢ç§»åŠ¨ç«¯æ»‘åŠ¨æ§åˆ¶
    (function() {
      const gridContainer = document.getElementById('grid-container');
      let touchStartX, touchStartY;

      gridContainer.addEventListener('touchstart', (e) => {
        if (e.touches.length > 1) return; // ä»…å¤„ç†å•æŒ‡æ“ä½œ
        touchStartX = e.touches[0].clientX;
        touchStartY = e.touches[0].clientY;
        e.preventDefault();
      });

      gridContainer.addEventListener('touchmove', (e) => {
        e.preventDefault(); // é˜»æ­¢é¡µé¢æ»šåŠ¨
      });

      gridContainer.addEventListener('touchend', (e) => {
        if (e.changedTouches.length === 0) return;
        
        const touchEndX = e.changedTouches[0].clientX;
        const touchEndY = e.changedTouches[0].clientY;
        const dx = touchEndX - touchStartX;
        const dy = touchEndY - touchStartY;
        const absDx = Math.abs(dx);
        const absDy = Math.abs(dy);

        // è®¾ç½®æ»‘åŠ¨é˜ˆå€¼ï¼ˆæœ€å°æ»‘åŠ¨è·ç¦»ï¼‰
        if (Math.max(absDx, absDy) < 10) return;

        // æ ¹æ®æ»‘åŠ¨æ–¹å‘è§¦å‘å¯¹åº”æ“ä½œ
        if (absDx > absDy) {
          if (dx > 0) moveRight();
          else moveLeft();
        } else {
          if (dy > 0) moveDown();
          else moveUp();
        }
      });
    })();

    // ç§»åŠ¨ç«¯è§¦æ‘¸äº‹ä»¶å¤„ç†ï¼ˆä½¿ç”¨æ¨¡æ‹Ÿæ§ä»¶ï¼‰
    document.getElementById("up").addEventListener("click", moveUp);
    document.getElementById("left").addEventListener("click", moveLeft);
    document.getElementById("down").addEventListener("click", moveDown);
    document.getElementById("right").addEventListener("click", moveRight);

    // ç§»åŠ¨ç«¯è§¦æ‘¸äº‹ä»¶æ”¯æŒï¼ˆç®€å•è¯†åˆ«ä¸Šä¸‹å·¦å³æ»‘åŠ¨ï¼‰
    /*let touchStartX = 0, touchStartY = 0;
    document.addEventListener("touchstart", (e) => {
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
    });
    document.addEventListener("touchend", (e) => {
      let dx = e.changedTouches[0].clientX - touchStartX;
      let dy = e.changedTouches[0].clientY - touchStartY;
      if (Math.abs(dx) > Math.abs(dy)) {
        // æ¨ªå‘æ»‘åŠ¨
        if (dx > 30) {
          moveRight();
        } else if (dx < -30) {
          moveLeft();
        }
      } else {
        // çºµå‘æ»‘åŠ¨
        if (dy > 30) {
          moveDown();
        } else if (dy < -30) {
          moveUp();
        }
      }
    });*/
    
    // è¯¾ç¨‹åˆ—è¡¨ï¼Œç”¨äºç”Ÿæˆæˆç»©å•ï¼ˆç¤ºä¾‹è¯¾ç¨‹ï¼Œå¯è‡ªè¡Œè¡¥å……ï¼‰
    const courses = [
      { name: "é«˜ç­‰æ•°å­¦(ä¸Š)", credit: 5 },
      { name: "é«˜ç­‰æ•°å­¦(ä¸‹)", credit: 5 },
      { name: "é©¬å…‹æ€ä¸»ä¹‰åŸºæœ¬åŸç†", credit: 3 },
      { name: "ç”µå·¥å­¦ï¼ˆç”µå·¥æŠ€æœ¯ï¼‰", credit: 3 },
      { name: "pythonç¨‹åºè®¾è®¡", credit: 2.5 },
      { name: "C++ç¨‹åºè®¾è®¡", credit: 2.5 },
      { name: "è®¡ç®—æ–¹æ³•", credit: 2 },
      { name: "æ˜ŸæœŸéŸ³ä¹ä¼š", credit: 1.5 },
      { name: "ç‰çŸ³é‰´èµ", credit: 1.5 },
      { name: "å¤§å­¦ç”Ÿå®‰å…¨æ•™è‚²", credit: 1.5 },
      { name: "ä¸–ç•Œå¤§æˆ˜", credit: 1.5 },
      { name: "ä¸“ä¸šå¯¼è®º", credit: 1.5 },
      { name: "å‘å±•å¿ƒç†å­¦", credit: 2 },
      { name: "ä¸­å›½è¿‘ç°ä»£å²çº²è¦", credit: 2},
      { name: "ä½“è‚²(4)", credit: 1 },
      { name: "ä½“è‚²(3)", credit: 1 },
      { name: "æ¦‚ç‡è®ºä¸æ•°ç†ç»Ÿè®¡", credit: 3 },
      { name: "çº¿æ€§ä»£æ•°", credit: 3 },
      { name: "ç¦»æ•£æ•°å­¦", credit: 3 },
      { name: "å¤§å­¦ç‰©ç†(ä¸Š)", credit: 3 },
      { name: "å¤§å­¦ç‰©ç†(ä¸‹)", credit: 3 },
      { name: "å¤§å­¦è‹±è¯­", credit: 2 },
      { name: "å¤§å­¦ç‰©ç†å®éªŒ", credit: 1 },
      { name: "æœºæ¢°åˆ¶å›¾", credit: 2.5 },
      { name: "ç”»æ³•å‡ ä½•", credit: 2 },
      { name: "å½¢åŠ¿ä¸æ”¿ç­–(4)", credit: 0.5 },
      { name: "å½¢åŠ¿ä¸æ”¿ç­–(3)", credit: 0.5 },
    ];
    
    // ç”Ÿæˆæˆç»©å•ï¼šå°†æ£‹ç›˜ä¸­æ‰€æœ‰éç©ºæ–¹å—éšæœºåˆ†é…ä¸åŒè¯¾ç¨‹ï¼Œå¹¶æ˜¾ç¤ºç¾åŒ–åçš„å¼¹çª—
    function generateTranscript() {
    // æ”¶é›†æ‰€æœ‰éç©ºæ–¹å—çš„æ•°å€¼
    let tiles = [];
    for (let i = 0; i < gridSize; i++) {
        for (let j = 0; j < gridSize; j++) {
        if (grid[i][j] !== 0) {
            tiles.push(grid[i][j]);
        }
        }
    }
    if (tiles.length === 0) {
        alert("å½“å‰æ²¡æœ‰æˆç»©å¯ä»¥ç”Ÿæˆæˆç»©å•ï¼");
        return;
    }
    // éšæœºæ‰“ä¹±è¯¾ç¨‹åˆ—è¡¨ï¼ˆç¡®ä¿ä¸é‡å¤ï¼‰
    let coursesCopy = courses.slice();
    shuffleArray(coursesCopy);
    // å¦‚æœæ–¹å—æ•°å¤šäºè¯¾ç¨‹æ•°ï¼Œåˆ™åªå–å·²æœ‰è¯¾ç¨‹æ•°
    const count = Math.min(tiles.length, coursesCopy.length);
    let transcriptItems = [];
    let totalCredit = 0, totalPoint = 0;
    for (let i = 0; i < count; i++) {
        const tileVal = tiles[i];
        const baseGrade = getBaseGrade(tileVal);
        const gradePoint = getGradePoint(tileVal);
        const course = coursesCopy[i];
        transcriptItems.push({
        name: course.name,
        credit: course.credit,
        grade: baseGrade,
        point: gradePoint
        });
        totalCredit += course.credit;
        totalPoint += course.credit * gradePoint;
    }
    const overallGPA = (totalPoint / totalCredit).toFixed(2);
    // ç»Ÿè®¡ä¸åŠæ ¼é—¨æ•°
    const failCount = transcriptItems.filter(item => item.grade === "ä¸åŠæ ¼").length;
    
    // æ„é€ æˆç»©å• HTML å†…å®¹ï¼Œä½¿ç”¨ç¾åŒ–åçš„ CSS ç±»å
    let transcriptHTML = `
        <div class="transcript-overlay">
        <div class="transcript-container">
            <h2>æˆç»©å•</h2>
            <p>ç»©ç‚¹: ${overallGPA} &nbsp;&nbsp; ä¸åŠæ ¼é—¨æ•°: ${failCount}</p>
            <table class="transcript-table">
            <tr>
                <th>è¯¾ç¨‹åç§°</th>
                <th>å­¦åˆ†</th>
                <th>æˆç»©</th>
                <th>ç»©ç‚¹</th>
            </tr>`;
    transcriptItems.forEach(item => {
        transcriptHTML += `<tr>
                <td>${item.name}</td>
                <td>${item.credit}</td>
                <td>${item.grade}</td>
                <td>${item.point}</td>
            </tr>`;
    });
    transcriptHTML += `
            </table>
            <button class="close-btn" onclick="this.parentElement.parentElement.remove()">å…³é—­</button>
        </div>
        </div>`;
    
    // å°†æˆç»©å•åŠ å…¥é¡µé¢
    const div = document.createElement("div");
    div.innerHTML = transcriptHTML;
    document.body.appendChild(div);
    }
    
    // å·¥å…·å‡½æ•°ï¼šéšæœºæ‰“ä¹±æ•°ç»„
    function shuffleArray(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }
    
    // åˆå§‹åŒ–æ¸¸æˆ
    document.addEventListener("DOMContentLoaded", initGame);
    </script>
    <style>


    </style>
    <script>//é©¬å…‹æ€è¯­å½•
      const quotes = [
          "å“²å­¦å®¶ä»¬åªæ˜¯ç”¨ä¸åŒçš„æ–¹å¼è§£é‡Šä¸–ç•Œï¼Œè€Œé—®é¢˜åœ¨äºæ”¹å˜ä¸–ç•Œã€‚",
          "å…¨ä¸–ç•Œæ— äº§è€…ï¼Œè”åˆèµ·æ¥ï¼",
          "èµ„æœ¬æ¥åˆ°ä¸–é—´ï¼Œä»å¤´åˆ°è„šæ¯ä¸ªæ¯›å­”éƒ½æ»´ç€è¡€å’Œè‚®è„çš„ä¸œè¥¿ã€‚",
          "å†å²æŠŠé‚£äº›ä¸ºå…±åŒç›®æ ‡å·¥ä½œå› è€Œè‡ªå·±å˜å¾—é«˜å°šçš„äººç§°ä¸ºæœ€ä¼Ÿå¤§çš„äººç‰©ã€‚",
          "ç¤¾ä¼šçš„è¿›æ­¥å°±æ˜¯äººç±»å¯¹ç¾çš„è¿½æ±‚çš„ç»“æ™¶ã€‚"
      ];

      function showRandomQuote() {
          const randomIndex = Math.floor(Math.random() * quotes.length);
          // ä½¿ç”¨innerHTMLå®ç°æ–œä½“åŒ…è£¹ [[4]]
          document.getElementById('quote').innerHTML = `<i>${quotes[randomIndex]}</i>`;
      }

      // é¡µé¢åŠ è½½è‡ªåŠ¨æ’­æ”¾ [[7]]
      document.addEventListener('DOMContentLoaded', () => {
          showRandomQuote(); // ç«‹å³æ˜¾ç¤ºç¬¬ä¸€æ¡
          setInterval(showRandomQuote, 20000);
      });
    </script>
</html>
